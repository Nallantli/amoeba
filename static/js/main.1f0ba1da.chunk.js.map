{"version":3,"sources":["Space.tsx","Chunk.tsx","utils.tsx","GameState.tsx","Board.tsx","assets/CircleIcon.tsx","assets/CrossIcon.tsx","assets/DiamondIcon.tsx","assets/SquareIcon.tsx","App.tsx","reportWebVitals.ts","ThemeSelector.tsx","AI.tsx","ais/utils.tsx","index.tsx","ais/Elk.tsx","ais/ElkAtt.tsx","ais/ElkDef.tsx","ais/Fuzzy.tsx"],"names":["Space","props","x","y","id","value","win","canPlayerMove","onClick","view","config","spaceSize","className","style","position","width","height","left","top","React","createElement","playerIcons","color","playerColors","Chunk","chunkData","posX","posY","chunkX","chunkY","selectSquare","map","col","cell","detail","flatten","d","fib","n","horizontalCount","gameState","v","ps","getValue","push","type","verticalCount","diagonalUp","diagonalDown","chunk","Math","floor","undefined","calculateLimitScore","playerCount","winLength","placements","matches","i","forEach","placement","e","length","flag","removes","p","a","b","j","sharePoint","old","playerScores","m","filter","score","addChunk","Limit","moveLimit","ScoreScreen","doLocalAITurn","boardRef","turnDelay","AIs","turn","pos","doTurn","setTimeout","current","dispatchEvent","CustomEvent","Board","bind","postMove","handleScroll","handleTouchStart","handleTouchMove","handleTouchEnd","handleZoom","handleKeyDown","handleKeyUp","createRef","state","offsetX","offsetY","xLow","xHigh","yLow","yHigh","isTouching","touchStart","touchOffset","shiftScroll","ctrlScroll","this","newSpaceSize","max","min","setState","preventDefault","exp","deltaY","deltaX","evt","originalEvent","touch","touches","changedTouches","pageX","pageY","pow","target","click","key","window","addEventListener","passive","newState","lastMove","isLimited","check","squares","s","document","getElementById","classList","add","checkWin","winner","sort","element","shadow","getComputedStyle","boxShadow","join","oldGameState","background","location","reload","ref","marginTop","marginLeft","Object","values","Component","CircleIcon","data-name","xmlns","viewBox","fill","CrossIcon","points","DiamondIcon","transform","SquareIcon","App","params","delay","get","parseInt","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","DefaultTheme","lazy","Win98Theme","ThemeSelector","Suspense","fallback","theme","children","AI","icon","pCount","_gameState","Error","countLine","dx","dy","l","nx","ny","nx2","ny2","Elk","highAtt","highDef","heatMap","h","o","att","def","Array","_","maxDef","maxAtt","attMap","defMap","random","ElkAtt","ElkDef","Fuzzy","URLSearchParams","search","limit","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.1f0ba1da.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { ConfigType } from \"./Board\";\r\n\r\ntype SpaceProps = {\r\n\tx: number;\r\n\ty: number;\r\n\tid: string;\r\n\tvalue: number;\r\n\twin: boolean;\r\n\tcanPlayerMove: boolean;\r\n\tonClick: (e: any) => void;\r\n\tview: { spaceSize: number };\r\n\tconfig: ConfigType;\r\n};\r\n\r\nexport const Space = (props: SpaceProps) => {\r\n\tconst { x, y, id, value, win, canPlayerMove, onClick, view, config } = props;\r\n\tconst { spaceSize } = view;\r\n\treturn (<button\r\n\t\tid={id}\r\n\t\tonClick={value === 0 && !win && canPlayerMove ? onClick : () => { }}\r\n\t\tclassName=\"space\"\r\n\t\tstyle={{\r\n\t\t\tposition: \"absolute\",\r\n\t\t\twidth: `${spaceSize}px`,\r\n\t\t\theight: `${spaceSize}px`,\r\n\t\t\tleft: `${x * spaceSize}px`,\r\n\t\t\ttop: `${y * spaceSize}px`\r\n\t\t}}\r\n\t>\r\n\t\t{value > 0 && React.createElement(config.playerIcons[value - 1], { color: config.playerColors[value - 1] })}\r\n\t</button>);\r\n}","import { ConfigType } from \"./Board\";\r\nimport { Space } from \"./Space\";\r\n\r\nexport const chunkSize = 3;\r\n\r\nexport const Chunk = (props: {\r\n\tchunkX: number;\r\n\tchunkY: number;\r\n\tselectSquare: (e: any) => void;\r\n\tchunkData: number[][];\r\n\tposX: number;\r\n\tposY: number;\r\n\twin: boolean;\r\n\tcanPlayerMove: boolean;\r\n\tview: { spaceSize: number; };\r\n\tconfig: ConfigType;\r\n}) => {\r\n\tconst { chunkData, posX, posY, chunkX, chunkY, win, canPlayerMove, view, selectSquare, config } = props;\r\n\tconst { spaceSize } = view;\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName=\"chunk\"\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: 'absolute',\r\n\t\t\t\twidth: `${chunkSize * spaceSize}px`,\r\n\t\t\t\theight: `${chunkSize * spaceSize}px`,\r\n\t\t\t\tleft: `${posX * chunkSize * spaceSize}px`,\r\n\t\t\t\ttop: `${posY * chunkSize * spaceSize}px`\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{chunkData.map((col, x) => {\r\n\t\t\t\treturn col.map((cell, y) =>\r\n\t\t\t\t\t<Space\r\n\t\t\t\t\t\tkey={`${x + chunkX * chunkSize}_${y + chunkY * chunkSize}`}\r\n\t\t\t\t\t\tid={`${x + chunkX * chunkSize}_${y + chunkY * chunkSize}`}\r\n\t\t\t\t\t\tvalue={cell}\r\n\t\t\t\t\t\tx={x}\r\n\t\t\t\t\t\ty={y}\r\n\t\t\t\t\t\tonClick={() => selectSquare({ detail: { x: chunkX * chunkSize + x, y: chunkY * chunkSize + y } })}\r\n\t\t\t\t\t\twin={win}\r\n\t\t\t\t\t\tcanPlayerMove={canPlayerMove}\r\n\t\t\t\t\t\tview={view}\r\n\t\t\t\t\t\tconfig={config}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t})}\r\n\t\t</div>\r\n\t)\r\n}","export function flatten(x: number, d: number): number {\r\n\twhile (x < 0)\r\n\t\tx += d;\r\n\treturn x % d;\r\n}\r\n\r\n/* carter code */\r\nexport function fib(n: number): number {\r\n\tif (n === 1 || n === 0)\r\n\t\treturn n;\r\n\telse\r\n\t\treturn fib(n - 2) + fib(n - 1);\r\n}","import { AI } from \"./AI\";\r\nimport { chunkSize } from \"./Chunk\";\r\nimport { fib, flatten } from \"./utils\";\r\n\r\nexport type GameState = {\r\n\tmap: { [key: string]: { x: number, y: number, chunkData: number[][] } };\r\n\tplacements: { x: number, y: number, v: number }[];\r\n\tplayerCount: number;\r\n\twinLength: number;\r\n\tmoveLimit: number;\r\n\tisLimited: boolean;\r\n\tturn: number;\r\n\tAIs: (AI | undefined)[];\r\n\twin: boolean;\r\n\tplayerScores: number[];\r\n};\r\n\r\nfunction horizontalCount(gameState: GameState, x: number, y: number, v: number) {\r\n\tlet ps = [];\r\n\twhile (getValue(gameState, x, y) === v) {\r\n\t\tps.push({ x, y });\r\n\t\tx++;\r\n\t}\r\n\treturn { ps, type: 0 };\r\n}\r\n\r\nfunction verticalCount(gameState: GameState, x: number, y: number, v: number) {\r\n\tlet ps = [];\r\n\twhile (getValue(gameState, x, y) === v) {\r\n\t\tps.push({ x, y });\r\n\t\ty++;\r\n\t}\r\n\treturn { ps, type: 1 };\r\n}\r\n\r\nfunction diagonalUp(gameState: GameState, x: number, y: number, v: number) {\r\n\tlet ps = [];\r\n\twhile (getValue(gameState, x, y) === v) {\r\n\t\tps.push({ x, y });\r\n\t\ty++;\r\n\t\tx++;\r\n\t}\r\n\treturn { ps, type: 2 };\r\n}\r\n\r\nfunction diagonalDown(gameState: GameState, x: number, y: number, v: number) {\r\n\tlet ps = [];\r\n\twhile (getValue(gameState, x, y) === v) {\r\n\t\tps.push({ x, y });\r\n\t\ty--;\r\n\t\tx++;\r\n\t}\r\n\treturn { ps, type: 3 };\r\n}\r\n\r\nexport function getValue(gameState: GameState, x: number, y: number) {\r\n\tconst { map } = gameState;\r\n\tconst chunk = map[Math.floor(x / chunkSize) + '_' + Math.floor(y / chunkSize)];\r\n\tif (chunk === undefined) {\r\n\t\treturn 0;\r\n\t}\r\n\treturn chunk.chunkData[flatten(x, chunkSize)][flatten(y, chunkSize)];\r\n}\r\n\r\nfunction sharePoint(a: { x: number, y: number }[], b: { x: number, y: number }[]) {\r\n\tfor (let i = 0; i < a.length; i++) {\r\n\t\tfor (let j = 0; j < b.length; j++) {\r\n\t\t\tif (a[i].x === b[j].x && a[i].y === b[j].y)\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction calculateLimitScore(gameState: GameState) {\r\n\tconst { playerCount, winLength, placements } = gameState;\r\n\tlet matches: { type: number, ps: { x: number, y: number }[], old?: boolean }[][] = [];\r\n\tfor (let i = 0; i < playerCount; i++) {\r\n\t\tmatches.push([]);\r\n\t}\r\n\tplacements.forEach((placement: { x: number, y: number, v: number }) => {\r\n\t\t[\r\n\t\t\thorizontalCount(gameState, placement.x, placement.y, placement.v),\r\n\t\t\tverticalCount(gameState, placement.x, placement.y, placement.v),\r\n\t\t\tdiagonalUp(gameState, placement.x, placement.y, placement.v),\r\n\t\t\tdiagonalDown(gameState, placement.x, placement.y, placement.v)\r\n\t\t].forEach(e => {\r\n\t\t\tif (e.ps.length < winLength) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet flag = false;\r\n\t\t\tlet removes: number[] = [];\r\n\t\t\tmatches[placement.v - 1].forEach((p: { type: number, ps: { x: number, y: number }[] }, i: number) => {\r\n\t\t\t\tif (p.type === e.type && sharePoint(p.ps, e.ps)) {\r\n\t\t\t\t\tif (p.ps.length < e.ps.length) {\r\n\t\t\t\t\t\tremoves.push(i);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tflag = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tremoves.forEach(i => matches[placement.v - 1][i].old = true);\r\n\t\t\tif (!flag) {\r\n\t\t\t\tmatches[placement.v - 1].push(e);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tlet playerScores: number[] = [];\r\n\tmatches.map(m => m.filter(e => e.old === undefined));\r\n\tmatches.forEach(e => {\r\n\t\tlet score = 0;\r\n\t\te.forEach(p => {\r\n\t\t\tscore += fib(p.ps.length - winLength + 2);\r\n\t\t});\r\n\t\tplayerScores.push(score);\r\n\t});\r\n\treturn playerScores;\r\n}\r\n\r\nexport function checkWin(gameState: GameState, lastMove: { x: number, y: number }): GameState {\r\n\tconst { x, y } = lastMove;\r\n\tconst { winLength, isLimited, moveLimit } = gameState;\r\n\tif (isLimited) {\r\n\t\tconst playerScores = calculateLimitScore(gameState);\r\n\t\tif (moveLimit === 0) {\r\n\t\t\treturn gameState = { ...gameState, win: true, playerScores };\r\n\t\t}\r\n\t\treturn gameState = { ...gameState, win: false, playerScores };\r\n\t} else {\r\n\t\tconst check = getValue(gameState, x, y);\r\n\t\tif (check === 0)\r\n\t\t\treturn gameState = { ...gameState, win: false, playerScores: [] };\r\n\t\tfor (let i = 0; i < winLength; i++) {\r\n\t\t\tlet squares = [];\r\n\t\t\tfor (let j = 0; j < winLength; j++) {\r\n\t\t\t\tlet s = getValue(gameState, x - i + j, y);\r\n\t\t\t\tif (s === undefined)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tif (s !== check)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tsquares.push((x - i + j) + \"_\" + y);\r\n\t\t\t}\r\n\t\t\tif (squares.length === winLength) {\r\n\t\t\t\tsquares.forEach((e) => document.getElementById(e)?.classList.add(\"win-square\"));\r\n\t\t\t\treturn gameState = { ...gameState, win: true, playerScores: [] };\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < winLength; i++) {\r\n\t\t\tlet squares = [];\r\n\t\t\tfor (let j = 0; j < winLength; j++) {\r\n\t\t\t\tconst s = getValue(gameState, x, y - i + j);\r\n\t\t\t\tif (s === undefined)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tif (s !== check)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tsquares.push(x + \"_\" + (y - i + j));\r\n\t\t\t}\r\n\t\t\tif (squares.length === winLength) {\r\n\t\t\t\tsquares.forEach((e) => document.getElementById(e)?.classList.add(\"win-square\"));\r\n\t\t\t\treturn gameState = { ...gameState, win: true, playerScores: [] };\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < winLength; i++) {\r\n\t\t\tlet squares = [];\r\n\t\t\tfor (let j = 0; j < winLength; j++) {\r\n\t\t\t\tlet s = getValue(gameState, x - i + j, y - i + j);\r\n\t\t\t\tif (s === undefined)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tif (s !== check)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tsquares.push((x - i + j) + \"_\" + (y - i + j));\r\n\t\t\t}\r\n\t\t\tif (squares.length === winLength) {\r\n\t\t\t\tsquares.forEach((e) => document.getElementById(e)?.classList.add(\"win-square\"));\r\n\t\t\t\treturn gameState = { ...gameState, win: true, playerScores: [] };\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < winLength; i++) {\r\n\t\t\tlet squares = [];\r\n\t\t\tfor (let j = 0; j < winLength; j++) {\r\n\t\t\t\tlet s = getValue(gameState, x - i + j, y + i - j);\r\n\t\t\t\tif (s === undefined)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tif (s !== check)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tsquares.push((x - i + j) + \"_\" + (y + i - j));\r\n\t\t\t}\r\n\t\t\tif (squares.length === winLength) {\r\n\t\t\t\tsquares.forEach((e) => document.getElementById(e)?.classList.add(\"win-square\"));\r\n\t\t\t\treturn gameState = { ...gameState, win: true, playerScores: [] };\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn gameState = { ...gameState, win: false, playerScores: [] };\r\n}\r\n\r\nexport function addChunk(gameState: GameState, x: number, y: number) {\r\n\tconst { map } = gameState;\r\n\tif (map[x + '_' + y] !== undefined) {\r\n\t\treturn gameState;\r\n\t}\r\n\tlet chunkData: number[][] = [];\r\n\tfor (let i = 0; i < chunkSize; i++) {\r\n\t\tchunkData[i] = [];\r\n\t\tfor (let j = 0; j < chunkSize; j++) {\r\n\t\t\tchunkData[i][j] = 0;\r\n\t\t}\r\n\t}\r\n\treturn gameState = {\r\n\t\t...gameState,\r\n\t\tmap: {\r\n\t\t\t...map,\r\n\t\t\t[`${x}_${y}`]: {\r\n\t\t\t\tx: x,\r\n\t\t\t\ty: y,\r\n\t\t\t\tchunkData\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function selectSquare(gameState: GameState, x: number, y: number) {\r\n\tconst { map, turn, moveLimit, placements, playerCount } = gameState;\r\n\tconst v = turn + 1;\r\n\tconst chunk = map[Math.floor(x / chunkSize) + '_' + Math.floor(y / chunkSize)];\r\n\tchunk.chunkData[flatten(x, chunkSize)][flatten(y, chunkSize)] = v;\r\n\tgameState = {\r\n\t\t...gameState,\r\n\t\tmap: {\r\n\t\t\t...map,\r\n\t\t\t[Math.floor(x / chunkSize) + '_' + Math.floor(y / chunkSize)]: chunk\r\n\t\t},\r\n\t\tplacements: [...placements, { x, y, v }],\r\n\t\tturn: (turn + 1) % playerCount,\r\n\t\tmoveLimit: moveLimit - (turn === playerCount - 1 ? 1 : 0)\r\n\t};\r\n\treturn { v, gameState };\r\n}","import React from 'react';\r\nimport { Chunk, chunkSize } from './Chunk';\r\nimport { addChunk, checkWin, GameState, getValue, selectSquare } from './GameState';\r\nimport { flatten } from './utils';\r\n\r\nexport type ConfigType = {\r\n\tplayerIcons: any[];\r\n\tplayerColors: string[];\r\n\tturnDelay: number;\r\n};\r\n\r\nconst Limit = (props: { moveLimit: number }) => {\r\n\treturn (<div id=\"limit-dialog\">Turns Left: {props.moveLimit}</div>);\r\n}\r\n\r\nconst ScoreScreen = (props: { playerScores: number[], config: ConfigType }) => {\r\n\treturn (\r\n\t\t<div id=\"score-dialog\">\r\n\t\t\t<table>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t{props.playerScores.map((score, i) => <tr key={i}><td style={{ width: \"40px\" }}>{React.createElement(props.config.playerIcons[i], { color: props.config.playerColors[i] })}</td><td>{score}</td></tr>)}\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\ntype BoardProps = {\r\n\tgameState: GameState;\r\n\tparams: any;\r\n\tconfig: ConfigType;\r\n};\r\n\r\ntype BoardState = {\r\n\tgameState: GameState;\r\n\tview: {\r\n\t\toffsetX: number;\r\n\t\toffsetY: number;\r\n\t\tspaceSize: number;\r\n\t};\r\n\txLow: number;\r\n\txHigh: number;\r\n\tyLow: number;\r\n\tyHigh: number;\r\n\tisTouching: boolean;\r\n\ttouchStart: { x: number, y: number };\r\n\ttouchOffset: { x: number, y: number };\r\n\tshiftScroll: boolean;\r\n\tctrlScroll: boolean;\r\n};\r\n\r\nfunction doLocalAITurn(gameState: GameState, boardRef: any, turnDelay: number) {\r\n\tif (gameState.AIs[gameState.turn] !== undefined) {\r\n\t\tconst pos = gameState.AIs[gameState.turn]?.doTurn(gameState);\r\n\t\tsetTimeout(\r\n\t\t\t() => boardRef.current?.dispatchEvent(\r\n\t\t\t\tnew CustomEvent('selectSquare',\r\n\t\t\t\t\t{ detail: { x: pos?.x, y: pos?.y } })),\r\n\t\t\tturnDelay);\r\n\t}\r\n}\r\n\r\nexport class Board extends React.Component<BoardProps, BoardState> {\r\n\tboardRef: React.RefObject<HTMLDivElement>;\r\n\tconstructor(props: BoardProps) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.addChunk = this.addChunk.bind(this);\r\n\t\tthis.selectSquare = this.selectSquare.bind(this);\r\n\t\tthis.postMove = this.postMove.bind(this);\r\n\t\tthis.handleScroll = this.handleScroll.bind(this);\r\n\t\tthis.handleTouchStart = this.handleTouchStart.bind(this);\r\n\t\tthis.handleTouchMove = this.handleTouchMove.bind(this);\r\n\t\tthis.handleTouchEnd = this.handleTouchEnd.bind(this);\r\n\t\tthis.handleZoom = this.handleZoom.bind(this);\r\n\t\tthis.handleKeyDown = this.handleKeyDown.bind(this);\r\n\t\tthis.handleKeyUp = this.handleKeyUp.bind(this);\r\n\r\n\t\tthis.boardRef = React.createRef();\r\n\r\n\t\tthis.state = {\r\n\t\t\tgameState: this.props.gameState,\r\n\t\t\tview: {\r\n\t\t\t\toffsetX: 0,\r\n\t\t\t\toffsetY: 0,\r\n\t\t\t\tspaceSize: 50\r\n\t\t\t},\r\n\t\t\txLow: 0,\r\n\t\t\txHigh: 0,\r\n\t\t\tyLow: 0,\r\n\t\t\tyHigh: 0,\r\n\t\t\tisTouching: false,\r\n\t\t\ttouchStart: { x: 0, y: 0 },\r\n\t\t\ttouchOffset: { x: 0, y: 0 },\r\n\t\t\tshiftScroll: false,\r\n\t\t\tctrlScroll: false\r\n\t\t}\r\n\t}\r\n\thandleZoom(v: number) {\r\n\t\tconst { offsetX, offsetY, spaceSize } = this.state.view;\r\n\t\tconst newSpaceSize = Math.max(15, Math.min(160, spaceSize * v));\r\n\t\tthis.setState({\r\n\t\t\tview: {\r\n\t\t\t\toffsetX: offsetX * (newSpaceSize / spaceSize),\r\n\t\t\t\toffsetY: offsetY * (newSpaceSize / spaceSize),\r\n\t\t\t\tspaceSize: newSpaceSize\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\thandleScroll(e: any) {\r\n\t\te.preventDefault();\r\n\t\tconst { shiftScroll, ctrlScroll } = this.state;\r\n\t\tconst { offsetX, offsetY, spaceSize } = this.state.view;\r\n\t\tif (ctrlScroll) {\r\n\t\t\tthis.handleZoom(Math.exp(e.deltaY / 200));\r\n\t\t} else {\r\n\t\t\tconst deltaX = e.deltaX * 0.25;\r\n\t\t\tconst deltaY = e.deltaY * 0.25;\r\n\t\t\tthis.setState({\r\n\t\t\t\tview: {\r\n\t\t\t\t\toffsetX: offsetX - (shiftScroll ? deltaY : deltaX),\r\n\t\t\t\t\toffsetY: offsetY - (shiftScroll ? deltaX : deltaY),\r\n\t\t\t\t\tspaceSize: spaceSize\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleTouchMove(e: any) {\r\n\t\te.preventDefault();\r\n\t\tconst evt = (typeof e.originalEvent === 'undefined') ? e : e.originalEvent;\r\n\t\tconst touch = evt.touches[0] || evt.changedTouches[0];\r\n\t\tthis.setState({\r\n\t\t\ttouchOffset: { x: touch.pageX, y: touch.pageY }\r\n\t\t});\r\n\t}\r\n\thandleTouchStart(e: any) {\r\n\t\te.preventDefault();\r\n\t\tconst evt = (typeof e.originalEvent === 'undefined') ? e : e.originalEvent;\r\n\t\tconst touch = evt.touches[0] || evt.changedTouches[0];\r\n\t\tthis.setState({\r\n\t\t\tisTouching: true,\r\n\t\t\ttouchStart: { x: touch.pageX, y: touch.pageY },\r\n\t\t\ttouchOffset: { x: touch.pageX, y: touch.pageY }\r\n\t\t});\r\n\t}\r\n\thandleTouchEnd(e: any) {\r\n\t\te.preventDefault();\r\n\t\tconst evt = (typeof e.originalEvent === 'undefined') ? e : e.originalEvent;\r\n\t\tconst touch = evt.touches[0] || evt.changedTouches[0];\r\n\t\tconst { view, touchStart, touchOffset } = this.state;\r\n\t\tconst { offsetX, offsetY, spaceSize } = view;\r\n\t\tthis.setState({\r\n\t\t\tisTouching: false,\r\n\t\t\tview: {\r\n\t\t\t\toffsetX: offsetX + (touchOffset.x - touchStart.x),\r\n\t\t\t\toffsetY: offsetY + (touchOffset.y - touchStart.y),\r\n\t\t\t\tspaceSize: spaceSize\r\n\t\t\t}\r\n\t\t}, () => {\r\n\t\t\tif (Math.pow(touchStart.x - touch.pageX, 2) + Math.pow(touchStart.y - touch.pageY, 2) < 10) {\r\n\t\t\t\tif (touch.target.click !== undefined) {\r\n\t\t\t\t\ttouch.target.click();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\thandleKeyDown(e: any) {\r\n\t\tswitch (e.key) {\r\n\t\t\tcase 'Shift':\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tshiftScroll: true\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Control':\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tctrlScroll: true\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\thandleKeyUp(e: any) {\r\n\t\tswitch (e.key) {\r\n\t\t\tcase 'Shift':\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tshiftScroll: false\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Control':\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tctrlScroll: false\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tcomponentDidMount() {\r\n\t\twindow.addEventListener('wheel', this.handleScroll, { passive: false });\r\n\t\twindow.addEventListener('touchstart', this.handleTouchStart, { passive: false });\r\n\t\twindow.addEventListener('touchmove', this.handleTouchMove, { passive: false });\r\n\t\twindow.addEventListener('touchend', this.handleTouchEnd, { passive: false });\r\n\t\twindow.addEventListener('touchcancel', this.handleTouchEnd, { passive: false });\r\n\t\twindow.addEventListener('keydown', this.handleKeyDown, { passive: false });\r\n\t\twindow.addEventListener('keyup', this.handleKeyUp, { passive: false });\r\n\t\tthis.boardRef.current?.addEventListener('selectSquare', this.selectSquare);\r\n\t\tlet newState = { ...this.state };\r\n\t\tfor (let i = -1; i <= 1; i++) {\r\n\t\t\tfor (let j = -1; j <= 1; j++) {\r\n\t\t\t\tnewState = { ...newState, ...this.addChunk(i, j, newState) };\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.setState(\r\n\t\t\t{ ...newState },\r\n\t\t\t() => doLocalAITurn(this.state.gameState, this.boardRef, this.props.config.turnDelay)\r\n\t\t);\r\n\t}\r\n\tpostMove(lastMove: { x: number, y: number, v: number }) {\r\n\t\tconst { config } = this.props;\r\n\t\tconst { gameState } = this.state;\r\n\t\tconst { isLimited, playerCount, placements, turn } = gameState;\r\n\t\tconst { win, playerScores } = checkWin(gameState, lastMove);\r\n\t\tlet newState = { ...this.state };\r\n\t\tif (win) {\r\n\t\t\tconst winner =\r\n\t\t\t\tflatten(\r\n\t\t\t\t\t(isLimited ?\r\n\t\t\t\t\t\tplayerScores.map((e, i) => ({ e, i })).sort((a, b) => b.e - a.e)[0].i\r\n\t\t\t\t\t\t: turn - 1),\r\n\t\t\t\t\tplayerCount\r\n\t\t\t\t);\r\n\t\t\tplacements.forEach(placement => {\r\n\t\t\t\tlet element = document.getElementById(placement.x + \"_\" + placement.y) as HTMLElement;\r\n\t\t\t\telement.classList.add(\"amoeba-square\");\r\n\t\t\t\tlet shadow = [];\r\n\t\t\t\tif (window.getComputedStyle(element).boxShadow !== \"none\") {\r\n\t\t\t\t\tshadow.push(window.getComputedStyle(element).boxShadow);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x, placement.y + 1) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} 0rem 5rem`);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x + 1, placement.y) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x, placement.y + 1) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x + 1, placement.y + 1) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} 5rem 5rem`);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x + 1, placement.y) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} 5rem 0rem`);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x + 1, placement.y) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x, placement.y - 1) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x + 1, placement.y - 1) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} 5rem -5rem`);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x, placement.y - 1) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} 0rem -5rem`);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x - 1, placement.y) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x, placement.y + 1) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x - 1, placement.y + 1) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} -5rem 5rem`);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x - 1, placement.y) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} -5rem 0rem`);\r\n\t\t\t\t}\r\n\t\t\t\tif (getValue(gameState, placement.x - 1, placement.y) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x, placement.y - 1) === 0\r\n\t\t\t\t\t&& getValue(gameState, placement.x - 1, placement.y - 1) === 0) {\r\n\t\t\t\t\tshadow.push(`${config.playerColors[winner]} -5rem -5rem`);\r\n\t\t\t\t}\r\n\t\t\t\telement.style.boxShadow = shadow.join(\", \");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconst chunkX = Math.floor(lastMove.x / chunkSize);\r\n\t\t\tconst chunkY = Math.floor(lastMove.y / chunkSize);\r\n\t\t\tfor (let i = -1; i <= 1; i++) {\r\n\t\t\t\tfor (let j = -1; j <= 1; j++) {\r\n\t\t\t\t\tif (i === 0 && j === 0) continue;\r\n\t\t\t\t\tnewState = { ...newState, ...this.addChunk(chunkX + i, chunkY + j, newState) };\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.setState(newState, () => doLocalAITurn(this.state.gameState, this.boardRef, this.props.config.turnDelay));\r\n\t\t}\r\n\t}\r\n\tselectSquare(e: any) {\r\n\t\tconst oldGameState = this.state.gameState;\r\n\t\tconst { x, y } = e.detail;\r\n\r\n\t\tdocument.getElementById(x + \"_\" + y)?.classList.add(\"space-pressed\");\r\n\t\tconst { v, gameState } = selectSquare(oldGameState, x, y);\r\n\t\tthis.setState({\r\n\t\t\tgameState: gameState\r\n\t\t}, () => {\r\n\t\t\tthis.postMove({ x, y, v });\r\n\t\t});\r\n\t}\r\n\taddChunk(x: number, y: number, newState: BoardState) {\r\n\t\tlet { gameState, xLow, yLow, xHigh, yHigh, view } = newState || this.state;\r\n\t\tlet { offsetX, offsetY, spaceSize } = view;\r\n\t\tif (x < xLow) {\r\n\t\t\txLow = x;\r\n\t\t\toffsetX -= chunkSize * spaceSize / 2;\r\n\t\t}\r\n\t\tif (y < yLow) {\r\n\t\t\tyLow = y;\r\n\t\t\toffsetY -= chunkSize * spaceSize / 2;\r\n\t\t}\r\n\t\tif (x > xHigh) {\r\n\t\t\txHigh = x;\r\n\t\t\toffsetX += chunkSize * spaceSize / 2;\r\n\t\t}\r\n\t\tif (y > yHigh) {\r\n\t\t\tyHigh = y;\r\n\t\t\toffsetY += chunkSize * spaceSize / 2;\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tgameState: addChunk(gameState, x, y),\r\n\t\t\txLow: xLow,\r\n\t\t\tyLow: yLow,\r\n\t\t\txHigh: xHigh,\r\n\t\t\tyHigh: yHigh,\r\n\t\t\tview: {\r\n\t\t\t\toffsetX: offsetX,\r\n\t\t\t\toffsetY: offsetY,\r\n\t\t\t\tspaceSize: spaceSize\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\trender() {\r\n\t\tconst { config } = this.props;\r\n\t\tconst { view,\r\n\t\t\tview: { offsetX, offsetY, spaceSize },\r\n\t\t\tisTouching, touchOffset, touchStart,\r\n\t\t\txLow, yLow, xHigh, yHigh,\r\n\t\t\tgameState: { moveLimit, playerScores, win, turn, map, AIs, isLimited, playerCount }\r\n\t\t} = this.state;\r\n\t\tconst width = spaceSize * chunkSize * (xHigh - xLow + 1);\r\n\t\tconst height = spaceSize * chunkSize * (yHigh - yLow + 1);\r\n\t\treturn (\r\n\t\t\t<div id=\"screen\">\r\n\t\t\t\t<div id=\"player-bar\"\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tbackground: (win ?\r\n\t\t\t\t\t\t\tconfig.playerColors[flatten((isLimited ?\r\n\t\t\t\t\t\t\t\tplayerScores.map((e, i) => ({ e, i })).sort((a, b) => b.e - a.e)[0].i\r\n\t\t\t\t\t\t\t\t: turn - 1), playerCount)]\r\n\t\t\t\t\t\t\t: config.playerColors[turn])\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<div id=\"zoom-bar\">\r\n\t\t\t\t\t<button id=\"zoom-in\" onClick={() => this.handleZoom(3 / 2)}>+</button>\r\n\t\t\t\t\t<button id=\"zoom-out\" onClick={() => this.handleZoom(2 / 3)}>-</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t{isLimited && <Limit moveLimit={moveLimit} />}\r\n\t\t\t\t{isLimited && <ScoreScreen playerScores={playerScores} config={config} />}\r\n\t\t\t\t<button id=\"reset-button\" onClick={() => window.location.reload()}>Reset Game</button>\r\n\t\t\t\t<div className=\"board\" ref={this.boardRef}>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"chunk-container\"\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\twidth: `${width}px`,\r\n\t\t\t\t\t\t\theight: `${height}px`,\r\n\t\t\t\t\t\t\tmarginTop: `${-height / 2 + offsetY + (isTouching ? (touchOffset.y - touchStart.y) : 0)}px`,\r\n\t\t\t\t\t\t\tmarginLeft: `${-width / 2 + offsetX + (isTouching ? (touchOffset.x - touchStart.x) : 0)}px`\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{Object.values(map).map(value =>\r\n\t\t\t\t\t\t\t<Chunk\r\n\t\t\t\t\t\t\t\tconfig={config}\r\n\t\t\t\t\t\t\t\tkey={value.x + '_' + value.y}\r\n\t\t\t\t\t\t\t\tposX={value.x - xLow}\r\n\t\t\t\t\t\t\t\tposY={value.y - yLow}\r\n\t\t\t\t\t\t\t\tchunkX={value.x}\r\n\t\t\t\t\t\t\t\tchunkY={value.y}\r\n\t\t\t\t\t\t\t\tchunkData={value.chunkData}\r\n\t\t\t\t\t\t\t\tselectSquare={this.selectSquare}\r\n\t\t\t\t\t\t\t\twin={win}\r\n\t\t\t\t\t\t\t\tcanPlayerMove={AIs[turn] === undefined}\r\n\t\t\t\t\t\t\t\tview={view}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","export const CircleIcon = (props: { color: string }) => {\r\n\treturn (\r\n\t\t<svg className=\"player-icon\" id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1000 1000\">\r\n\t\t\t<path fill={props.color} d=\"M500,0C223.86,0,0,223.86,0,500s223.86,500,500,500,500-223.86,500-500S776.14,0,500,0Zm0,800c-165.69,0-300-134.31-300-300S334.31,200,500,200,800,334.31,800,500,665.69,800,500,800Z\" />\r\n\t\t</svg>\r\n\t);\r\n}","export const CrossIcon = (props: { color: string }) => {\r\n\treturn (\r\n\t\t<svg className=\"player-icon\" id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1000 1000\">\r\n\t\t\t<polygon fill={props.color} points=\"1000 858.58 641.42 500 1000 141.42 858.58 0 500 358.58 141.42 0 0 141.42 358.58 500 0 858.58 141.42 1000 500 641.42 858.58 1000 1000 858.58\" />\r\n\t\t</svg>\r\n\t);\r\n}","export const DiamondIcon = (props: { color: string }) => {\r\n\treturn (\r\n\t\t<svg className=\"player-icon\" id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1000 1000\">\r\n\t\t\t<path fill={props.color} d=\"M500,0,0,500l500,500,500-500Zm0,717.16L282.84,500,500,282.84,717.16,500Z\" transform=\"translate(0 0)\" />\r\n\t\t</svg>\r\n\t);\r\n}","export const SquareIcon = (props: { color: string }) => {\r\n\treturn (\r\n\t\t<svg className=\"player-icon\" id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1000 1000\">\r\n\t\t\t<path fill={props.color} d=\"M0,0V1000H1000V0ZM800,800H200V200H800Z\" />\r\n\t\t</svg>\r\n\t);\r\n}","import { Board } from './Board';\nimport { CircleIcon } from './assets/CircleIcon';\nimport { CrossIcon } from './assets/CrossIcon';\nimport { DiamondIcon } from './assets/DiamondIcon';\nimport { SquareIcon } from './assets/SquareIcon';\n\nfunction App(props: any) {\n\tconst { params, gameState } = props;\n\tconst delay = params.get('delay') ? parseInt(params.get('delay') as string, 10) : 0;\n\n\treturn (<Board\n\t\tconfig={{\n\t\t\tplayerColors: [\n\t\t\t\t'#5588ff',\n\t\t\t\t'#ff3344',\n\t\t\t\t\"#33ff44\",\n\t\t\t\t'#ffcc33'\n\t\t\t],\n\t\t\tplayerIcons: [\n\t\t\t\tCircleIcon,\n\t\t\t\tCrossIcon,\n\t\t\t\tDiamondIcon,\n\t\t\t\tSquareIcon\n\t\t\t],\n\t\t\tturnDelay: delay\n\t\t}}\n\t\tgameState={gameState}\n\t\tparams={params}\n\t/>);\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\n\r\n/**\r\n * The theme components only imports it's theme CSS-file. These components are lazy\r\n * loaded, to enable \"code splitting\" (in order to avoid the themes being bundled together)\r\n */\r\nconst DefaultTheme = React.lazy(() => import('./styles/App'));\r\nconst Win98Theme = React.lazy(() => import('./styles/Win98'));\r\n\r\nconst ThemeSelector = (props: { theme: string; children: any; }) => (\r\n  <>\r\n    {/* Conditionally render theme, based on the current client context */}\r\n    <React.Suspense fallback={() => <div />}>\r\n      {props.theme === 'default' && <DefaultTheme />}\r\n      {props.theme === 'win98' && <Win98Theme />}\r\n    </React.Suspense>\r\n    {/* Render children immediately! */}\r\n    {props.children}\r\n  </>\r\n);\r\n\r\nexport default ThemeSelector;\r\n","import { GameState } from \"./GameState\";\r\n\r\nexport class AI {\r\n\twinLength: number;\r\n\ticon: number;\r\n\tpCount: number;\r\n\tconstructor(\r\n\t\twinLength: number,\r\n\t\ticon: number,\r\n\t\tpCount: number\r\n\t) {\r\n\t\tthis.winLength = winLength;\r\n\t\tthis.icon = icon;\r\n\t\tthis.pCount = pCount;\r\n\t}\r\n\tdoTurn(_gameState: GameState): { x: number, y: number } {\r\n\t\tthrow new Error(\"Method not implemented.\");\r\n\t}\r\n}","import { GameState } from \"../GameState\";\r\n\r\nexport function countLine(gameState: GameState, x: number, y: number, v: number, dx: number, dy: number, getValue: (gameState: GameState, x: number, y: number) => number, winLength: number): number {\r\n\tlet l = 0;\r\n\tlet i = -1;\r\n\twhile (getValue(gameState, x + i * dx, y + i * dy) === v) {\r\n\t\tlet d = 0;\r\n\t\tlet nx = x + i * dx;\r\n\t\tlet ny = y + i * dy;\r\n\t\twhile (getValue(gameState, nx, ny) === v || (nx === x && ny === y)) {\r\n\t\t\td++;\r\n\t\t\tnx += dx;\r\n\t\t\tny += dy;\r\n\t\t}\r\n\t\tif (d < winLength) {\r\n\t\t\tfor (let j = d; j <= winLength; j++) {\r\n\t\t\t\tlet nx2 = x + (i + j) * dx;\r\n\t\t\t\tlet ny2 = y + (i + j) * dy;\r\n\t\t\t\tif (getValue(gameState, nx2, ny2) !== v && getValue(gameState, nx2, ny2) !== 0) {\r\n\t\t\t\t\td = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (d > l) {\r\n\t\t\tl = d;\r\n\t\t}\r\n\t\ti--;\r\n\t}\r\n\treturn l;\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css'\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport ThemeSelector from './ThemeSelector';\nimport { AI } from './AI';\nimport { Elk } from './ais/Elk';\nimport { ElkAtt } from './ais/ElkAtt';\nimport { ElkDef } from './ais/ElkDef';\nimport { Fuzzy } from './ais/Fuzzy';\n\nconst params = new URLSearchParams(window.location.search);\nconst winLength = params.get('win') ? parseInt(params.get('win') as string, 10) : 5;\nconst playerCount = params.get('count') ? parseInt(params.get('count') as string, 10) : 2;\nconst limit = params.get('limit') ? parseInt(params.get('limit') as string, 10) : 0;\n\nlet AIs: (AI | undefined)[] = [];\nfor (let i = 0; i < playerCount; i++) {\n\tswitch (params.get(`p${i + 1}`)) {\n\t\tcase \"fuzzy\":\n\t\t\tAIs.push(new Fuzzy(winLength, i + 1, playerCount));\n\t\t\tbreak;\n\t\tcase \"elk\":\n\t\t\tAIs.push(new Elk(winLength, i + 1, playerCount));\n\t\t\tbreak;\n\t\tcase \"elkatt\":\n\t\t\tAIs.push(new ElkAtt(winLength, i + 1, playerCount));\n\t\t\tbreak;\n\t\tcase \"elkdef\":\n\t\t\tAIs.push(new ElkDef(winLength, i + 1, playerCount));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tAIs.push(undefined);\n\t\t\tbreak;\n\t}\n}\n\nconst gameState = {\n\tturn: 0,\n\tplacements: [],\n\tmap: {},\n\tplayerCount: playerCount,\n\tmoveLimit: (limit > 0 ? limit : 0),\n\twinLength: winLength,\n\tisLimited: limit > 0,\n\tAIs: AIs,\n\twin: false,\n\tplayerScores: Array(playerCount).fill(0)\n}\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<ThemeSelector theme={params.get('theme') || 'default'}>\n\t\t\t<App gameState={gameState} params={params} />\n\t\t</ThemeSelector>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { AI } from \"../AI\";\r\nimport { GameState, getValue } from \"../GameState\";\r\nimport { countLine } from \"./utils\";\r\n\r\nexport class Elk extends AI {\r\n\tdoTurn(gameState: GameState) {\r\n\t\tconst { placements } = gameState;\r\n\t\tlet highAtt = 0;\r\n\t\tlet highDef = 0;\r\n\t\tlet heatMap: { x: number; y: number; att: number; def: number; }[] = [];\r\n\t\tplacements.forEach(e => {\r\n\t\t\tfor (let x = -1; x <= 1; x++) {\r\n\t\t\t\tfor (let y = -1; y <= 1; y++) {\r\n\t\t\t\t\tif (x === 0 && y === 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (getValue(gameState, e.x + x, e.y + y) !== 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet flag = false;\r\n\t\t\t\t\theatMap.forEach(h => {\r\n\t\t\t\t\t\tif (h.x === e.x + x && h.y === e.y + y) {\r\n\t\t\t\t\t\t\tflag = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (flag) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet o = {\r\n\t\t\t\t\t\tx: e.x + x,\r\n\t\t\t\t\t\ty: e.y + y,\r\n\t\t\t\t\t\tatt: Math.max(\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, -1, getValue, this.winLength)),\r\n\t\t\t\t\t\tdef: Math.max(...Array(this.pCount).fill(0).map((_, i) => {\r\n\t\t\t\t\t\t\treturn Math.max(\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, -1, getValue, this.winLength))\r\n\t\t\t\t\t\t}).filter((_, i) => i !== this.icon - 1))\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (o.att > highAtt) {\r\n\t\t\t\t\t\thighAtt = o.att;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (o.def > highDef) {\r\n\t\t\t\t\t\thighDef = o.def;\r\n\t\t\t\t\t}\r\n\t\t\t\t\theatMap.push(o);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (heatMap.length === 0) {\r\n\t\t\treturn { x: 0, y: 0 };\r\n\t\t} else {\r\n\t\t\tlet maxDef = 0;\r\n\t\t\tlet maxAtt = 0;\r\n\t\t\tlet attMap = heatMap.filter(e => e.att === highAtt);\r\n\t\t\tattMap.forEach(e => {\r\n\t\t\t\tif (e.def > maxDef) {\r\n\t\t\t\t\tmaxDef = e.def;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattMap = attMap.filter(e => e.def === maxDef);\r\n\t\t\tlet defMap = heatMap.filter(e => e.def === highDef);\r\n\t\t\tdefMap.forEach(e => {\r\n\t\t\t\tif (e.att > maxAtt) {\r\n\t\t\t\t\tmaxAtt = e.att;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdefMap = defMap.filter(e => e.att === maxAtt);\r\n\t\t\treturn (highAtt - highDef) > 0 ? attMap[Math.floor(Math.random() * attMap.length)] : defMap[Math.floor(Math.random() * defMap.length)];\r\n\t\t}\r\n\t}\r\n}","import { AI } from \"../AI\";\r\nimport { GameState, getValue } from \"../GameState\";\r\nimport { countLine } from \"./utils\";\r\n\r\nexport class ElkAtt extends AI {\r\n\tdoTurn(gameState: GameState) {\r\n\t\tconst { placements } = gameState;\r\n\t\tlet highAtt = 0;\r\n\t\tlet highDef = 0;\r\n\t\tlet heatMap: { x: number; y: number; att: number; def: number; }[] = [];\r\n\t\tplacements.forEach(e => {\r\n\t\t\tfor (let x = -1; x <= 1; x++) {\r\n\t\t\t\tfor (let y = -1; y <= 1; y++) {\r\n\t\t\t\t\tif (x === 0 && y === 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (getValue(gameState, e.x + x, e.y + y) !== 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet flag = false;\r\n\t\t\t\t\theatMap.forEach(h => {\r\n\t\t\t\t\t\tif (h.x === e.x + x && h.y === e.y + y) {\r\n\t\t\t\t\t\t\tflag = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (flag) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet o = {\r\n\t\t\t\t\t\tx: e.x + x,\r\n\t\t\t\t\t\ty: e.y + y,\r\n\t\t\t\t\t\tatt: Math.max(\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, -1, getValue, this.winLength)),\r\n\t\t\t\t\t\tdef: Math.max(...Array(this.pCount).fill(0).map((_, i) => {\r\n\t\t\t\t\t\t\treturn Math.max(\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, -1, getValue, this.winLength))\r\n\t\t\t\t\t\t}).filter((_, i) => i !== this.icon - 1))\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (o.att > highAtt) {\r\n\t\t\t\t\t\thighAtt = o.att;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (o.def > highDef) {\r\n\t\t\t\t\t\thighDef = o.def;\r\n\t\t\t\t\t}\r\n\t\t\t\t\theatMap.push(o);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (heatMap.length === 0) {\r\n\t\t\treturn { x: 0, y: 0 };\r\n\t\t} else {\r\n\t\t\tlet maxDef = 0;\r\n\t\t\tlet maxAtt = 0;\r\n\t\t\tlet attMap = heatMap.filter(e => e.att === highAtt);\r\n\t\t\tattMap.forEach(e => {\r\n\t\t\t\tif (e.def > maxDef) {\r\n\t\t\t\t\tmaxDef = e.def;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattMap = attMap.filter(e => e.def === maxDef);\r\n\t\t\tlet defMap = heatMap.filter(e => e.def === highDef);\r\n\t\t\tdefMap.forEach(e => {\r\n\t\t\t\tif (e.att > maxAtt) {\r\n\t\t\t\t\tmaxAtt = e.att;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdefMap = defMap.filter(e => e.att === maxAtt);\r\n\t\t\treturn (highAtt - highDef) > -1 ? attMap[Math.floor(Math.random() * attMap.length)] : defMap[Math.floor(Math.random() * defMap.length)];\r\n\t\t}\r\n\t}\r\n}","import { AI } from \"../AI\";\r\nimport { GameState, getValue } from \"../GameState\";\r\nimport { countLine } from \"./utils\";\r\n\r\nexport class ElkDef extends AI {\r\n\tdoTurn(gameState: GameState) {\r\n\t\tconst { placements } = gameState;\r\n\t\tlet highAtt = 0;\r\n\t\tlet highDef = 0;\r\n\t\tlet heatMap: { x: number; y: number; att: number; def: number; }[] = [];\r\n\t\tplacements.forEach(e => {\r\n\t\t\tfor (let x = -1; x <= 1; x++) {\r\n\t\t\t\tfor (let y = -1; y <= 1; y++) {\r\n\t\t\t\t\tif (x === 0 && y === 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (getValue(gameState, e.x + x, e.y + y) !== 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet flag = false;\r\n\t\t\t\t\theatMap.forEach(h => {\r\n\t\t\t\t\t\tif (h.x === e.x + x && h.y === e.y + y) {\r\n\t\t\t\t\t\t\tflag = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (flag) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet o = {\r\n\t\t\t\t\t\tx: e.x + x,\r\n\t\t\t\t\t\ty: e.y + y,\r\n\t\t\t\t\t\tatt: Math.max(\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, -1, getValue, this.winLength)),\r\n\t\t\t\t\t\tdef: Math.max(...Array(this.pCount).fill(0).map((_, i) => {\r\n\t\t\t\t\t\t\treturn Math.max(\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, -1, getValue, this.winLength))\r\n\t\t\t\t\t\t}).filter((_, i) => i !== this.icon - 1))\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (o.att > highAtt) {\r\n\t\t\t\t\t\thighAtt = o.att;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (o.def > highDef) {\r\n\t\t\t\t\t\thighDef = o.def;\r\n\t\t\t\t\t}\r\n\t\t\t\t\theatMap.push(o);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (heatMap.length === 0) {\r\n\t\t\treturn { x: 0, y: 0 };\r\n\t\t} else {\r\n\t\t\tlet maxDef = 0;\r\n\t\t\tlet maxAtt = 0;\r\n\t\t\tlet attMap = heatMap.filter(e => e.att === highAtt);\r\n\t\t\tattMap.forEach(e => {\r\n\t\t\t\tif (e.def > maxDef) {\r\n\t\t\t\t\tmaxDef = e.def;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattMap = attMap.filter(e => e.def === maxDef);\r\n\t\t\tlet defMap = heatMap.filter(e => e.def === highDef);\r\n\t\t\tdefMap.forEach(e => {\r\n\t\t\t\tif (e.att > maxAtt) {\r\n\t\t\t\t\tmaxAtt = e.att;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdefMap = defMap.filter(e => e.att === maxAtt);\r\n\t\t\treturn (highAtt - highDef) > 1 ? attMap[Math.floor(Math.random() * attMap.length)] : defMap[Math.floor(Math.random() * defMap.length)];\r\n\t\t}\r\n\t}\r\n}","import { AI } from \"../AI\";\r\nimport { GameState, getValue } from \"../GameState\";\r\nimport { countLine } from \"./utils\";\r\n\r\nexport class Fuzzy extends AI {\r\n\tdoTurn(gameState: GameState) {\r\n\t\tconst { placements } = gameState;\r\n\t\tlet highAtt = 0;\r\n\t\tlet highDef = 0;\r\n\t\tlet heatMap: { x: number; y: number; att: number; def: number; }[] = [];\r\n\t\tplacements.forEach(e => {\r\n\t\t\tfor (let x = -1; x <= 1; x++) {\r\n\t\t\t\tfor (let y = -1; y <= 1; y++) {\r\n\t\t\t\t\tif (x === 0 && y === 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (getValue(gameState, e.x + x, e.y + y) !== 0) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet flag = false;\r\n\t\t\t\t\theatMap.forEach(h => {\r\n\t\t\t\t\t\tif (h.x === e.x + x && h.y === e.y + y) {\r\n\t\t\t\t\t\t\tflag = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (flag) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet o = {\r\n\t\t\t\t\t\tx: e.x + x,\r\n\t\t\t\t\t\ty: e.y + y,\r\n\t\t\t\t\t\tatt: Math.max(\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, this.icon, 1, -1, getValue, this.winLength)),\r\n\t\t\t\t\t\tdef: Math.max(...Array(this.pCount).fill(0).map((_, i) => {\r\n\t\t\t\t\t\t\treturn Math.max(\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, 0, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, -1, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 0, -1, getValue, this.winLength),\r\n\t\t\t\t\t\t\t\tcountLine(gameState, e.x + x, e.y + y, i + 1, 1, -1, getValue, this.winLength))\r\n\t\t\t\t\t\t}).filter((_, i) => i !== this.icon - 1))\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (o.att > highAtt) {\r\n\t\t\t\t\t\thighAtt = o.att;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (o.def > highDef) {\r\n\t\t\t\t\t\thighDef = o.def;\r\n\t\t\t\t\t}\r\n\t\t\t\t\theatMap.push(o);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (heatMap.length === 0) {\r\n\t\t\treturn { x: 0, y: 0 };\r\n\t\t} else {\r\n\t\t\tlet maxDef = 0;\r\n\t\t\tlet maxAtt = 0;\r\n\t\t\tlet attMap = heatMap.filter(e => e.att === highAtt);\r\n\t\t\tattMap.forEach(e => {\r\n\t\t\t\tif (e.def > maxDef) {\r\n\t\t\t\t\tmaxDef = e.def;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattMap = attMap.filter(e => e.def === maxDef);\r\n\t\t\tlet defMap = heatMap.filter(e => e.def === highDef);\r\n\t\t\tdefMap.forEach(e => {\r\n\t\t\t\tif (e.att > maxAtt) {\r\n\t\t\t\t\tmaxAtt = e.att;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdefMap = defMap.filter(e => e.att === maxAtt);\r\n\t\t\tif (highAtt >= this.winLength) {\r\n\t\t\t\treturn attMap[Math.floor(Math.random() * attMap.length)];\r\n\t\t\t}\r\n\t\t\tif (highDef >= this.winLength) {\r\n\t\t\t\treturn defMap[Math.floor(Math.random() * defMap.length)];\r\n\t\t\t}\r\n\t\t\treturn highAtt >= highDef ? attMap[Math.floor(Math.random() * attMap.length)] : defMap[Math.floor(Math.random() * defMap.length)];\r\n\t\t}\r\n\t}\r\n}"],"sourceRoot":""}